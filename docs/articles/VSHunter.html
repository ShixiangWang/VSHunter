<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VSHunter: Decode Pattern of Copy Number Profile • VSHunter</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="VSHunter: Decode Pattern of Copy Number Profile">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VSHunter</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/VSHunter.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ShixiangWang/VSHunter">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>VSHunter: Decode Pattern of Copy Number Profile</h1>
                        <h4 class="author">Shixiang Wang  ShanghaiTech. University</h4>
            
            <h4 class="date">2018-12-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ShixiangWang/VSHunter/blob/master/vignettes/VSHunter.Rmd"><code>vignettes/VSHunter.Rmd</code></a></small>
      <div class="hidden name"><code>VSHunter.Rmd</code></div>

    </div>

    
    
<p>The goal of VSHunter is to capture variation signature from genomic data. For now, we decode copy number pattern from <strong>absolute copy number profile</strong>. This package collects R code from paper <em><a href="https://www.nature.com/articles/s41588-018-0179-8">Copy number signatures and mutational processes in ovarian carcinoma</a></em> and tidy them as a open source R package for bioinformatics community.</p>
<p>Before you use this tool, you have to obtain <strong>absolute copy number profile</strong> for samples via software like ABSOLUTE v2, QDNASeq etc..</p>
<div id="procedure" class="section level2">
<h2 class="hasAnchor">
<a href="#procedure" class="anchor"></a>Procedure</h2>
<ol style="list-style-type: decimal">
<li>summarise copy-number profile using a number of different feature distributions:
<ul>
<li>Sgement size</li>
<li>Breakpoint number (per ten megabases)</li>
<li>change-point copy-number</li>
<li>Breakpoint number (per chromosome arm)</li>
<li>Length of segments with oscillating copy-number</li>
</ul>
</li>
<li>apply mixture modelling to breakdown each feature distribution into mixtures of Gaussian or mixtures of Poisson distributions using the flexmix package.</li>
<li>generate a sample-by-component matrix representing the sum of posterior probabilities of each copy-number event being assigned to each component.</li>
<li>use NMF package to factorise the sample-by-component matrix into a signature-by-sample matrix and component-by signature-matrix.</li>
</ol>
<div class="figure" style="text-align: center">
<img src="https://media.springernature.com/m685/springer-static/image/art%3A10.1038%2Fs41588-018-0179-8/MediaObjects/41588_2018_179_Fig1_HTML.png" alt="Copy number signature identification, Macintyre, Geoff, et al.(2018)"><p class="caption">
Copy number signature identification, Macintyre, Geoff, et al.(2018)
</p>
</div>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install UCSCXenaTools from github with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" title="2">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"ShixiangWang/VSHunter"</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Load package.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(VSHunter)</a></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>Load example data:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">load</span>(<span class="kw">system.file</span>(<span class="st">"extdata/example_cn_list.RData"</span>, <span class="dt">package =</span> <span class="st">"VSHunter"</span>))</a></code></pre></div>
<p><code>tcga_segTabs</code> is a list contain absolute copy number profile for multiple samples, each sample is a <code>data.frame</code> in the list.</p>
<p>Obtain CNV summary info.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">tcga_frac =<span class="st"> </span><span class="kw"><a href="../reference/cnv_getLengthFraction.html">cnv_getLengthFraction</a></span>(tcga_segTabs)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt; Warning in cnv_getLengthFraction(tcga_segTabs): '23' is not a supported</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; chromosome, related rows will be discarded.</span></a></code></pre></div>
<div id="derive-feature-distributions" class="section level3">
<h3 class="hasAnchor">
<a href="#derive-feature-distributions" class="anchor"></a>Derive feature distributions</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">tcga_features =<span class="st"> </span><span class="kw"><a href="../reference/cnv_derivefeatures.html">cnv_derivefeatures</a></span>(<span class="dt">CN_data =</span> tcga_segTabs, <span class="dt">cores =</span> <span class="dv">1</span>, <span class="dt">genome_build =</span> <span class="st">"hg19"</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; Warning in getBPnum(CN_data, chrlen): '23' is not a supported chromosome,</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt; related rows will be discarded.</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt; Warning in getOscilation(CN_data): '23' is not a supported chromosome,</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt; related rows will be discarded.</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt; Warning in getCentromereDistCounts(CN_data, centromeres, chrlen): '23' is</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt; not a supported chromosome, related rows will be discarded.</span></a></code></pre></div>
</div>
<div id="fit-model-components" class="section level3">
<h3 class="hasAnchor">
<a href="#fit-model-components" class="anchor"></a>Fit model components</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">tcga_components =<span class="st"> </span><span class="kw"><a href="../reference/cnv_fitMixModels.html">cnv_fitMixModels</a></span>(<span class="dt">CN_features =</span> tcga_features, <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
</div>
<div id="generate-a-sample-by-component-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#generate-a-sample-by-component-matrix" class="anchor"></a>Generate a sample-by-component matrix</h3>
<p>Generate a sample-by-component matrix representing the sum of posterior probabilities of each copy-number event being assigned to each component.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">tcga_sample_component_matrix =<span class="st"> </span><span class="kw"><a href="../reference/cnv_generateSbCMatrix.html">cnv_generateSbCMatrix</a></span>(tcga_features, tcga_components, <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
</div>
<div id="choose-optimal-number-of-signatures-" class="section level3">
<h3 class="hasAnchor">
<a href="#choose-optimal-number-of-signatures-" class="anchor"></a>Choose optimal number of signatures.</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">tcga_sig_choose =<span class="st"> </span><span class="kw"><a href="../reference/cnv_chooseSigNumber.html">cnv_chooseSigNumber</a></span>(tcga_sample_component_matrix, <span class="dt">nrun =</span> <span class="dv">10</span>, <span class="dt">cores =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; Estimating best rank..</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; Compute NMF rank= 2  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; Compute NMF rank= 3  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; Compute NMF rank= 4  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; Compute NMF rank= 5  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; Compute NMF rank= 6  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; Compute NMF rank= 7  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; Compute NMF rank= 8  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; Compute NMF rank= 9  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt; Compute NMF rank= 10  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt; Compute NMF rank= 11  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt; Compute NMF rank= 12  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt;    method   seed rng metric rank sparseness.basis sparseness.coef</span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">#&gt; 2  brunet random   1     KL    2        0.6489683       0.4322189</span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt; 3  brunet random   2     KL    3        0.6142799       0.4984319</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">#&gt; 4  brunet random   3     KL    4        0.6685100       0.5401982</span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#&gt; 5  brunet random   4     KL    5        0.6560764       0.4773139</span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#&gt; 6  brunet random   4     KL    6        0.6410512       0.5204883</span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">#&gt; 7  brunet random   4     KL    7        0.6412633       0.5092596</span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">#&gt; 8  brunet random   4     KL    8        0.6685275       0.5023854</span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">#&gt; 9  brunet random   4     KL    9        0.6826431       0.5006178</span></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="co">#&gt; 10 brunet random   5     KL   10        0.6504016       0.5127575</span></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="co">#&gt; 11 brunet random   1     KL   11        0.6960388       0.5112119</span></a>
<a class="sourceLine" id="cb8-25" title="25"><span class="co">#&gt; 12 brunet random   4     KL   12        0.6925852       0.5062999</span></a>
<a class="sourceLine" id="cb8-26" title="26"><span class="co">#&gt;           rss      evar silhouette.coef silhouette.basis  residuals niter</span></a>
<a class="sourceLine" id="cb8-27" title="27"><span class="co">#&gt; 2  87298.8567 0.9772809       1.0000000        1.0000000 1300.82840   440</span></a>
<a class="sourceLine" id="cb8-28" title="28"><span class="co">#&gt; 3  41968.6019 0.9890779       0.7614656        0.7384315  720.76085  1180</span></a>
<a class="sourceLine" id="cb8-29" title="29"><span class="co">#&gt; 4  17990.1148 0.9953182       0.6367657        0.6885032  358.50895   790</span></a>
<a class="sourceLine" id="cb8-30" title="30"><span class="co">#&gt; 5   8344.3822 0.9978284       0.5944109        0.5356420  250.30470   850</span></a>
<a class="sourceLine" id="cb8-31" title="31"><span class="co">#&gt; 6   6609.5339 0.9982799       0.5919581        0.5875211  199.66517  1540</span></a>
<a class="sourceLine" id="cb8-32" title="32"><span class="co">#&gt; 7   5730.2758 0.9985087       0.4404151        0.3916044  157.08709   730</span></a>
<a class="sourceLine" id="cb8-33" title="33"><span class="co">#&gt; 8   4019.4472 0.9989540       0.4240787        0.4974423  119.07745  1340</span></a>
<a class="sourceLine" id="cb8-34" title="34"><span class="co">#&gt; 9   1902.8989 0.9995048       0.3888588        0.3237052   92.29312  2000</span></a>
<a class="sourceLine" id="cb8-35" title="35"><span class="co">#&gt; 10  1451.7440 0.9996222       0.2707051        0.3458225   73.22050  1500</span></a>
<a class="sourceLine" id="cb8-36" title="36"><span class="co">#&gt; 11  1222.0242 0.9996820       0.2525762        0.3692754   59.61798  2000</span></a>
<a class="sourceLine" id="cb8-37" title="37"><span class="co">#&gt; 12   848.6553 0.9997791       0.2591439        0.4399106   47.14418  2000</span></a>
<a class="sourceLine" id="cb8-38" title="38"><span class="co">#&gt;      cpu cpu.all nrun cophenetic dispersion silhouette.consensus</span></a>
<a class="sourceLine" id="cb8-39" title="39"><span class="co">#&gt; 2  0.099   3.906   10  0.9874746  0.8701313            0.9450441</span></a>
<a class="sourceLine" id="cb8-40" title="40"><span class="co">#&gt; 3  0.206   3.116   10  0.9675288  0.8374649            0.8970294</span></a>
<a class="sourceLine" id="cb8-41" title="41"><span class="co">#&gt; 4  0.087   3.077   10  0.9780816  0.8585785            0.8750204</span></a>
<a class="sourceLine" id="cb8-42" title="42"><span class="co">#&gt; 5  0.149   3.177   10  0.9806623  0.8592666            0.8614892</span></a>
<a class="sourceLine" id="cb8-43" title="43"><span class="co">#&gt; 6  0.281   3.185   10  0.9490230  0.7271888            0.6938755</span></a>
<a class="sourceLine" id="cb8-44" title="44"><span class="co">#&gt; 7  0.157   3.084   10  0.9566635  0.7525396            0.6563727</span></a>
<a class="sourceLine" id="cb8-45" title="45"><span class="co">#&gt; 8  0.279   3.107   10  0.9654777  0.7834676            0.6952167</span></a>
<a class="sourceLine" id="cb8-46" title="46"><span class="co">#&gt; 9  0.400   3.142   10  0.9507996  0.7611951            0.5829273</span></a>
<a class="sourceLine" id="cb8-47" title="47"><span class="co">#&gt; 10 0.307   3.114   10  0.9410231  0.7368583            0.4483320</span></a>
<a class="sourceLine" id="cb8-48" title="48"><span class="co">#&gt; 11 0.454   3.111   10  0.9309618  0.7162517            0.4398692</span></a>
<a class="sourceLine" id="cb8-49" title="49"><span class="co">#&gt; 12 0.449   3.078   10  0.9339152  0.7420009            0.4386445</span></a>
<a class="sourceLine" id="cb8-50" title="50"><span class="co">#&gt; Using 3 as a best-fit rank based on decreasing cophenetic correlation coefficient.</span></a>
<a class="sourceLine" id="cb8-51" title="51"><span class="co">#&gt; Generating random matrix and run NMF...</span></a>
<a class="sourceLine" id="cb8-52" title="52"><span class="co">#&gt; Compute NMF rank= 2  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-53" title="53"><span class="co">#&gt; Compute NMF rank= 3  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-54" title="54"><span class="co">#&gt; Compute NMF rank= 4  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-55" title="55"><span class="co">#&gt; Compute NMF rank= 5  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-56" title="56"><span class="co">#&gt; Compute NMF rank= 6  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-57" title="57"><span class="co">#&gt; Compute NMF rank= 7  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-58" title="58"><span class="co">#&gt; Compute NMF rank= 8  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-59" title="59"><span class="co">#&gt; Compute NMF rank= 9  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-60" title="60"><span class="co">#&gt; Compute NMF rank= 10  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-61" title="61"><span class="co">#&gt; Compute NMF rank= 11  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-62" title="62"><span class="co">#&gt; Compute NMF rank= 12  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb8-63" title="63"><span class="co">#&gt; Creating nmf rank survey plot...</span></a></code></pre></div>
<p><img src="VSHunter_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Do not test a randomise data (save time).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">tcga_sig_choose2 =<span class="st"> </span><span class="kw"><a href="../reference/cnv_chooseSigNumber.html">cnv_chooseSigNumber</a></span>(tcga_sample_component_matrix, <span class="dt">nrun =</span> <span class="dv">10</span>, <span class="dt">cores =</span> <span class="dv">4</span>, <span class="dt">testRandom =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#&gt; Estimating best rank..</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt; Compute NMF rank= 2  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; Compute NMF rank= 3  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#&gt; Compute NMF rank= 4  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt; Compute NMF rank= 5  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt; Compute NMF rank= 6  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; Compute NMF rank= 7  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt; Compute NMF rank= 8  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; Compute NMF rank= 9  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt; Compute NMF rank= 10  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; Compute NMF rank= 11  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; Compute NMF rank= 12  ... + measures ... OK</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#&gt;    method   seed rng metric rank sparseness.basis sparseness.coef</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">#&gt; 2  brunet random   1     KL    2        0.6489683       0.4322189</span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">#&gt; 3  brunet random   2     KL    3        0.6142799       0.4984319</span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#&gt; 4  brunet random   3     KL    4        0.6685100       0.5401982</span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">#&gt; 5  brunet random   4     KL    5        0.6560764       0.4773139</span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#&gt; 6  brunet random   4     KL    6        0.6410512       0.5204883</span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co">#&gt; 7  brunet random   4     KL    7        0.6412633       0.5092596</span></a>
<a class="sourceLine" id="cb9-21" title="21"><span class="co">#&gt; 8  brunet random   4     KL    8        0.6685275       0.5023854</span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">#&gt; 9  brunet random   4     KL    9        0.6826431       0.5006178</span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">#&gt; 10 brunet random   5     KL   10        0.6504016       0.5127575</span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co">#&gt; 11 brunet random   1     KL   11        0.6960388       0.5112119</span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co">#&gt; 12 brunet random   4     KL   12        0.6925852       0.5062999</span></a>
<a class="sourceLine" id="cb9-26" title="26"><span class="co">#&gt;           rss      evar silhouette.coef silhouette.basis  residuals niter</span></a>
<a class="sourceLine" id="cb9-27" title="27"><span class="co">#&gt; 2  87298.8567 0.9772809       1.0000000        1.0000000 1300.82840   440</span></a>
<a class="sourceLine" id="cb9-28" title="28"><span class="co">#&gt; 3  41968.6019 0.9890779       0.7614656        0.7384315  720.76085  1180</span></a>
<a class="sourceLine" id="cb9-29" title="29"><span class="co">#&gt; 4  17990.1148 0.9953182       0.6367657        0.6885032  358.50895   790</span></a>
<a class="sourceLine" id="cb9-30" title="30"><span class="co">#&gt; 5   8344.3822 0.9978284       0.5944109        0.5356420  250.30470   850</span></a>
<a class="sourceLine" id="cb9-31" title="31"><span class="co">#&gt; 6   6609.5339 0.9982799       0.5919581        0.5875211  199.66517  1540</span></a>
<a class="sourceLine" id="cb9-32" title="32"><span class="co">#&gt; 7   5730.2758 0.9985087       0.4404151        0.3916044  157.08709   730</span></a>
<a class="sourceLine" id="cb9-33" title="33"><span class="co">#&gt; 8   4019.4472 0.9989540       0.4240787        0.4974423  119.07745  1340</span></a>
<a class="sourceLine" id="cb9-34" title="34"><span class="co">#&gt; 9   1902.8989 0.9995048       0.3888588        0.3237052   92.29312  2000</span></a>
<a class="sourceLine" id="cb9-35" title="35"><span class="co">#&gt; 10  1451.7440 0.9996222       0.2707051        0.3458225   73.22050  1500</span></a>
<a class="sourceLine" id="cb9-36" title="36"><span class="co">#&gt; 11  1222.0242 0.9996820       0.2525762        0.3692754   59.61798  2000</span></a>
<a class="sourceLine" id="cb9-37" title="37"><span class="co">#&gt; 12   848.6553 0.9997791       0.2591439        0.4399106   47.14418  2000</span></a>
<a class="sourceLine" id="cb9-38" title="38"><span class="co">#&gt;      cpu cpu.all nrun cophenetic dispersion silhouette.consensus</span></a>
<a class="sourceLine" id="cb9-39" title="39"><span class="co">#&gt; 2  0.112   3.081   10  0.9874746  0.8701313            0.9450441</span></a>
<a class="sourceLine" id="cb9-40" title="40"><span class="co">#&gt; 3  0.204   3.161   10  0.9675288  0.8374649            0.8970294</span></a>
<a class="sourceLine" id="cb9-41" title="41"><span class="co">#&gt; 4  0.090   3.206   10  0.9780816  0.8585785            0.8750204</span></a>
<a class="sourceLine" id="cb9-42" title="42"><span class="co">#&gt; 5  0.171   3.176   10  0.9806623  0.8592666            0.8614892</span></a>
<a class="sourceLine" id="cb9-43" title="43"><span class="co">#&gt; 6  0.296   3.143   10  0.9490230  0.7271888            0.6938755</span></a>
<a class="sourceLine" id="cb9-44" title="44"><span class="co">#&gt; 7  0.174   3.120   10  0.9566635  0.7525396            0.6563727</span></a>
<a class="sourceLine" id="cb9-45" title="45"><span class="co">#&gt; 8  0.252   3.135   10  0.9654777  0.7834676            0.6952167</span></a>
<a class="sourceLine" id="cb9-46" title="46"><span class="co">#&gt; 9  0.393   3.121   10  0.9507996  0.7611951            0.5829273</span></a>
<a class="sourceLine" id="cb9-47" title="47"><span class="co">#&gt; 10 0.344   3.067   10  0.9410231  0.7368583            0.4483320</span></a>
<a class="sourceLine" id="cb9-48" title="48"><span class="co">#&gt; 11 0.429   3.123   10  0.9309618  0.7162517            0.4398692</span></a>
<a class="sourceLine" id="cb9-49" title="49"><span class="co">#&gt; 12 0.459   3.192   10  0.9339152  0.7420009            0.4386445</span></a>
<a class="sourceLine" id="cb9-50" title="50"><span class="co">#&gt; Using 3 as a best-fit rank based on decreasing cophenetic correlation coefficient.</span></a>
<a class="sourceLine" id="cb9-51" title="51"><span class="co">#&gt; Creating nmf rank survey plot...</span></a></code></pre></div>
<p><img src="VSHunter_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="extract-signatures" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-signatures" class="anchor"></a>Extract signatures</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">tcga_signatures =<span class="st"> </span><span class="kw"><a href="../reference/cnv_extractSignatures.html">cnv_extractSignatures</a></span>(tcga_sample_component_matrix, <span class="dt">nsig =</span> <span class="dv">3</span>, <span class="dt">cores =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt; Running NMF based on specified rank...</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt; NMF algorithm: 'brunet'</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt; Multiple runs: 1000</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt; Mode: parallel (4/8 core(s))</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-7" title="7">Runs<span class="op">:</span><span class="st"> </span><span class="er">|</span><span class="st">                                                        </span></a>
<a class="sourceLine" id="cb10-8" title="8">Runs<span class="op">:</span><span class="st"> </span><span class="er">|</span><span class="st">                                                  </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb10-9" title="9">Runs<span class="op">:</span><span class="st"> </span><span class="er">|</span><span class="st">                                                        </span></a>
<a class="sourceLine" id="cb10-10" title="10">Runs<span class="op">:</span><span class="st"> </span><span class="er">|==================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt; System time:</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt;    用户    系统    流逝 </span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt;   3.049   0.249 295.557</span></a></code></pre></div>
</div>
<div id="quantify-exposure-for-samples" class="section level3">
<h3 class="hasAnchor">
<a href="#quantify-exposure-for-samples" class="anchor"></a>Quantify exposure for samples</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">w =<span class="st"> </span>NMF<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/NMF/topics/basis-coef-methods">basis</a></span>(tcga_signatures)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">#h = NMF::coef(tcga_signatures)</span></a>
<a class="sourceLine" id="cb11-3" title="3">tcga_exposure =<span class="st"> </span><span class="kw"><a href="../reference/cnv_quantifySigExposure.html">cnv_quantifySigExposure</a></span>(<span class="dt">sample_by_component =</span> tcga_sample_component_matrix, <span class="dt">component_by_signature =</span> w)</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt; Quantifying exposure of signatures by LCD analysis...</span></a></code></pre></div>
</div>
<div id="auto-capture-signatures" class="section level3">
<h3 class="hasAnchor">
<a href="#auto-capture-signatures" class="anchor"></a>Auto-capture signatures</h3>
<p>Function <code><a href="../reference/cnv_autoCaptureSignatures.html">cnv_autoCaptureSignatures()</a></code> finish three steps (choose best number of signatures, extract signatures and quantify exposure) above in an antomated way. The arguments of this function are same as <code><a href="../reference/cnv_chooseSigNumber.html">cnv_chooseSigNumber()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">tcga_results =<span class="st"> </span><span class="kw"><a href="../reference/cnv_autoCaptureSignatures.html">cnv_autoCaptureSignatures</a></span>(tcga_sample_component_matrix, <span class="dt">nrun=</span><span class="dv">10</span>, <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>The result object is a <code>list</code> which contains all results need fro downstream analysis, include NMF result related to best rank value, signature matrix, absolute and relative exposure (contribution) and best rank survey etc..</p>
</div>
<div id="cnv-signature-calling-pipeline" class="section level3">
<h3 class="hasAnchor">
<a href="#cnv-signature-calling-pipeline" class="anchor"></a>CNV signature calling pipeline</h3>
<p>This feature is implemented in <code><a href="../reference/cnv_pipe.html">cnv_pipe()</a></code> function.</p>
</div>
</div>
<div id="visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#visualization" class="anchor"></a>Visualization</h2>
<p>Visualize CNV distribution by normalized CN length or chromosome.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="../reference/cnv_plotDistributionProfile.html">cnv_plotDistributionProfile</a></span>(tcga_frac)</a></code></pre></div>
<p><img src="VSHunter_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw"><a href="../reference/cnv_plotDistributionProfile.html">cnv_plotDistributionProfile</a></span>(tcga_frac, <span class="dt">mode =</span> <span class="st">"cd"</span>)</a></code></pre></div>
<p><img src="VSHunter_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="../reference/cnv_plotDistributionProfile.html">cnv_plotDistributionProfile</a></span>(tcga_frac, <span class="dt">mode =</span> <span class="st">"cd"</span> , <span class="dt">fill =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="VSHunter_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>Plot functions:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw"><a href="../reference/cnv_plotDistributionProfile.html">cnv_plotDistributionProfile</a></span>()</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw"><a href="../reference/cnv_plotFeatureDistribution.html">cnv_plotFeatureDistribution</a></span>()</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="kw"><a href="../reference/cnv_plotMixComponents.html">cnv_plotMixComponents</a></span>()</a>
<a class="sourceLine" id="cb16-4" title="4"><span class="kw"><a href="../reference/cnv_plotSignatures.html">cnv_plotSignatures</a></span>()</a></code></pre></div>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<ul>
<li><em>Macintyre, Geoff, et al. “Copy number signatures and mutational processes in ovarian carcinoma.” Nature genetics 50.9 (2018): 1262.</em></li>
</ul>
<p>If you wanna thank my work for this package, you can also cite (and inlucde link of this package - <a href="https://github.com/ShixiangWang/VSHunter" class="uri">https://github.com/ShixiangWang/VSHunter</a>):</p>
<ul>
<li><em>Wang, Shixiang, et al. “APOBEC3B and APOBEC mutational signature as potential predictive markers for immunotherapy response in non-small cell lung cancer.” Oncogene (2018).</em></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#procedure">Procedure</a></li>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#usage">Usage</a></li>
      <li><a href="#visualization">Visualization</a></li>
      <li><a href="#citation">Citation</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Shixiang Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
