---
title: "Test"
author: "Shixiang Wang"
date: "2018/11/13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
devtools::load_all()
library(flexmix)
library(QDNAseq)
library(NMF)
```


Load example data:

```{r}
load(system.file("inst/extdata", "example_cn_list.RData", package = "cnPattern"))
```

`tcga_segTabs` is a list contain absolute copy number profile for multiple samples, each sample is a `data.frame` in the list.

Derive feature distributions.

```{r}
tcga_features = derive_features(CN_data = tcga_segTabs, cores = 4, genome_build = "hg19")
```

Fit model components.

```{r}
tcga_components = fit_mixModels(CN_features = tcga_features, cores = 4)
```

Generate a sample-by-component matrix representing the sum of posterior probabilities of each copy-number event being assigned to each component.

```{r}
tcga_sample_component_matrix = generate_sbcMatrix(tcga_features, tcga_components, cores = 4)
```


Choose optimal number of signatures.

```{r}
choose_nSignatures(tcga_sample_component_matrix, iter = 5, cores = 4)
```

